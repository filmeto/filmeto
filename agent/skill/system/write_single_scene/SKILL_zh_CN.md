---
name: write_single_scene
description: 编写和更新剧本中单个场景的技能
---

# 单个场景编写技能

此技能允许代理在项目的剧本中编写和更新单个场景。它可以创建新场景或修改现有场景，并遵循好莱坞标准的格式和元数据。

## 功能

- 使用正确的剧本格式编写新的单个场景
- 使用新内容或元数据更新现有场景
- 应用好莱坞标准剧本格式（场景标题、动作、角色名称、对话）
- 修改场景元数据（地点、时间、角色、故事节拍等）
- 在更新特定元素时保留现有场景信息
- 遵循行业标准剧本结构和格式

## 约束

- **需要上下文**：此技能需要有效的 ToolContext 和剧本管理器的访问权限
- **需要剧本管理器**：项目必须具有初始化的剧本管理器来存储场景
- **唯一的 scene_id**：每个场景在项目中必须具有唯一的标识符
- **内容格式**：场景内容应遵循好莱坞剧本格式，并使用正确的场景标题（使用 # 表示标题）
- **更新行为**：如果存在具有相同 `scene_id` 的场景，它将使用新内容/元数据进行更新，同时保留未更改的字段
- **修订跟踪**：每次更新都会增加 revision_number；created_at 和 updated_at 时间戳会自动管理

## 输入要求

通过 `execute_skill_script` 调用脚本时提供以下输入：

- `scene_id`（字符串，必需）：唯一标识符（例如 `scene_001`）。在项目中必须唯一。
- `title`（字符串，必需）：场景标题或标题行。
- `content`（字符串，必需）：好莱坞格式的剧本内容。使用 `#` 表示场景标题。
- `scene_number`（字符串，可选）：序列号，如"1"、"1A"、"2"。
- `location`（字符串，可选）：场景地点。
- `time_of_day`（字符串，可选）：DAY、NIGHT、DAWN、DUSK、MORNING、AFTERNOON、EVENING。
- `genre`（字符串，可选）：类型分类。
- `logline`（字符串，可选）：一句话总结。
- `characters`（数组，可选）：出现在场景中的角色名称。
- `story_beat`（字符串，可选）：故事节拍或情节点。
- `page_count`（整数，可选）：预估页数（1页 ≈ 1分钟）。
- `duration_minutes`（整数，可选）：预估时长（分钟）。
- `tags`（数组，可选）：分类标签。
- `status`（字符串，可选，默认："draft"）：场景工作流状态。

如果提示中缺少必填字段，请推断它们：使用 `scene_###` 生成 `scene_id`，创建简洁的 `title`，并起草与请求的场景详情匹配的 `content`。

## 使用方法

当用户想要创建或更新剧本中的特定场景时，可以调用此技能。它接受场景详细信息并使用项目的剧本管理器存储更新的场景。

**最佳实践：**
- 使用描述性的 scene_id（例如 `scene_001`、`scene_002`）以便于引用
- 使用好莱坞格式在场景内容中包含地点和 time_of_day：`# INT. 地点 - 时间`
- 提供一句话总结以快速概述场景的目的
- 分配 characters 数组以跟踪每个场景中出现哪些角色
- 使用 story_beat 表示场景在整个故事结构中的作用
- 设置适当的 status 以跟踪场景在写作工作流程中的进度

## 参数示例

```json
{
  "scene_id": "scene_001",
  "title": "开场场景 - 爵士俱乐部",
  "content": "# INT. 爵士俱乐部 - 夜\n\n烟雾在昏暗的灯光中缭绕，萨克斯风在呜咽。杰克·梦露，40多岁，饱经风霜的面容，坐在吧台前喝着威士忌。\n\n**杰克**\n*(对酒保说)*\n再来一杯。这次要双份。\n\n门猛地推开。莉拉·陈，30多岁，穿着红色连衣裙，优雅地扫视着房间。",
  "scene_number": "1",
  "location": "爵士俱乐部",
  "time_of_day": "NIGHT",
  "characters": ["杰克·梦露", "莉拉·陈"],
  "story_beat": "角色介绍",
  "logline": "杰克的例行夜晚被一个神秘女子进入爵士俱乐部而打断",
  "duration_minutes": 3,
  "tags": ["开场", "夜晚", "爵士俱乐部"],
  "status": "draft"
}
```

## 输出

返回包含以下内容的 JSON 对象：
- `success`：指示操作是否成功的布尔值
- `action`："created"或"updated" - 指示是创建了新场景还是更新了现有场景
- `scene_id`：已创建或更新的场景的 ID
- `title`：场景的标题
- `message`：人类可读的状态消息，包含有关操作的详细信息

## 错误处理

- 如果缺少必需参数（scene_id、title、content），则返回错误
- 如果上下文中没有剧本管理器，则返回错误
- 如果场景创建或更新失败，返回 success=false
- 检查响应中的 `success` 字段以验证操作是否成功完成
